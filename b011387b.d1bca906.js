(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{124:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(0),o=n.n(a);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=o.a.createContext({}),b=function(e){var t=o.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=b(e.components);return o.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},u=o.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,r=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),p=b(n),u=a,m=p["".concat(r,".").concat(u)]||p[u]||d[u]||l;return n?o.a.createElement(m,i(i({ref:t},s),{},{components:n})):o.a.createElement(m,i({ref:t},s))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,r=new Array(l);r[0]=u;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:a,r[1]=i;for(var s=2;s<l;s++)r[s]=n[s];return o.a.createElement.apply(null,r)}return o.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},97:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return i})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return b}));var a=n(2),o=n(7),l=(n(0),n(124)),r={id:"docker-windows",title:"FlexIt Docker Deployment",hide_title:!0,sidebar_label:"Docker (Windows Containers)"},i={unversionedId:"docker-windows",id:"docker-windows",isDocsHomePage:!1,title:"FlexIt Docker Deployment",description:"Deploy FlexIt",source:"@site/docs\\docker-windows.md",slug:"/docker-windows",permalink:"/docs/docker-windows",editUrl:"https://github.com/flexanalytics/flexit-docs/edit/master/docs/docker-windows.md",version:"current",sidebar_label:"Docker (Windows Containers)",sidebar:"docs",previous:{title:"FlexIt Docker Deployment",permalink:"/docs/docker"},next:{title:"FlexIt Cloud Deployment",permalink:"/docs/cloud"}},c=[{value:"System Requirements",id:"system-requirements",children:[]},{value:"Prerequisites",id:"prerequisites",children:[]},{value:"Deployment Options",id:"deployment-options",children:[{value:"Required Containers",id:"required-containers",children:[]}]},{value:"Installation Instructions",id:"installation-instructions",children:[{value:"1. Clone the Repository",id:"1-clone-the-repository",children:[]},{value:"2. Configure Environment Variables",id:"2-configure-environment-variables",children:[]}]},{value:"Installation and Setup",id:"installation-and-setup",children:[{value:"Installing for the first time",id:"installing-for-the-first-time",children:[]},{value:"Access FlexIt",id:"access-flexit",children:[]}]},{value:"Managing the Docker Containers",id:"managing-the-docker-containers",children:[{value:"Stopping the Application",id:"stopping-the-application",children:[]},{value:"Starting the Application",id:"starting-the-application",children:[]},{value:"Restarting the Application",id:"restarting-the-application",children:[]}]},{value:"Cleaning up artifacts to free up space",id:"cleaning-up-artifacts-to-free-up-space",children:[{value:"stop all containers (PowerShell)",id:"stop-all-containers-powershell",children:[]},{value:"delete all containers (PowerShell)",id:"delete-all-containers-powershell",children:[]},{value:"delete all images (PowerShell)",id:"delete-all-images-powershell",children:[]},{value:"prune to clear up space",id:"prune-to-clear-up-space",children:[]}]},{value:"Working with Volumes",id:"working-with-volumes",children:[]},{value:"Additional Notes",id:"additional-notes",children:[{value:"Viewing Logs",id:"viewing-logs",children:[]}]},{value:"Troubleshooting",id:"troubleshooting",children:[{value:"1. PostgreSQL Connection Issues",id:"1-postgresql-connection-issues",children:[]},{value:"2. FlexIt Frontend Not Starting",id:"2-flexit-frontend-not-starting",children:[]}]}],s={rightToc:c};function b(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(l.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(l.b)("h1",{id:"deploy-flexit"},"Deploy FlexIt"),Object(l.b)("p",null,Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/flexanalytics/flexit-docker-windows"}),"This repository")," provides everything needed to deploy FlexIt using Docker."),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"For Linux Installation see ",Object(l.b)("a",Object(a.a)({parentName:"strong"},{href:"/docs/docker"}),"this guide"))),Object(l.b)("h2",{id:"system-requirements"},"System Requirements"),Object(l.b)("p",null,"Ensure you are able to run PowerShell as Administrator, as Docker needs elevated privileges to run Windows containers.\nWindows containers only run on Windows 10 or Windows Server 2022 and later."),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},Object(l.b)("strong",{parentName:"p"},"Note")," FlexIt via Docker does not support SQL Server database connections using Windows Domain authentication. If you need to connect to SQL Server, you must use SQL authentication.\nIf you need to connect to SQL Server using Windows authentication, please follow the ",Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/on-premise"}),"on-premise installation instructions"),".")),Object(l.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(l.b)("p",null,Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"https://git-scm.com/downloads"}),"Git")," or ",Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"https://desktop.github.com/"}),"GitHub Desktop")," in order to clone the repository and install FlexIt.\nDocker and Docker Compose will be automatically installed via the install script if not already on your system."),Object(l.b)("h2",{id:"deployment-options"},"Deployment Options"),Object(l.b)("p",null,"This repository allows for the following deployment options:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"With all containers"),": FlexIt Frontend and PostgreSQL backend."),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"Without PostgreSQL"),": Use an external content database while deploying the FlexIt Frontend.")),Object(l.b)("h3",{id:"required-containers"},"Required Containers"),Object(l.b)("p",null,"The ",Object(l.b)("strong",{parentName:"p"},"FlexIt Analytics")," (",Object(l.b)("inlineCode",{parentName:"p"},"flexit-analytics"),") container is the only mandatory container. All other containers are optional based on your setup."),Object(l.b)("h2",{id:"installation-instructions"},"Installation Instructions"),Object(l.b)("h3",{id:"1-clone-the-repository"},"1. Clone the Repository"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"git clone https://github.com/flexanalytics/flexit-docker-windows.git\ncd flexit-docker-windows\n")),Object(l.b)("h3",{id:"2-configure-environment-variables"},"2. Configure Environment Variables"),Object(l.b)("p",null,"Rename the ",Object(l.b)("inlineCode",{parentName:"p"},".env.template")," file to ",Object(l.b)("inlineCode",{parentName:"p"},".env")," and update the following:"),Object(l.b)("p",null,"frontend app configuration (modification in optional, the below defaults are provided):"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-env"}),"## --frontend app port number-- ##\nFLEXIT_PORT=3030\nFLEXIT_VERSION=latest\n")),Object(l.b)("p",null,"backend database configuration (add credentials for the containerized PostgreSQL database):"),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},"If you are using an external content database, set the ",Object(l.b)("inlineCode",{parentName:"p"},"USE_CONTENT_DB_CONTAINER")," variable to ",Object(l.b)("inlineCode",{parentName:"p"},"false"),".")),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-env"}),"## --backend database credentials-- ##\nUSE_CONTENT_DB_CONTAINER=true\nCONTENT_DB_VERSION=latest\nDB_USER=''\nDB_PASSWORD=''\nDB_NAME=''\nDB_PORT=5432\n")),Object(l.b)("p",null,"Ensure the image tag in the ",Object(l.b)("inlineCode",{parentName:"p"},"Dockerfile")," matches the version of Windows you are using. The default is ",Object(l.b)("inlineCode",{parentName:"p"},"windows-ltsc2022"),"."),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},Object(l.b)("strong",{parentName:"p"},"Note"),":"),Object(l.b)("ul",{parentName:"blockquote"},Object(l.b)("li",{parentName:"ul"},"If you are using an external content database, you will be prompted to set up the database credentials upon creating your account in FlexIt."))),Object(l.b)("h2",{id:"installation-and-setup"},"Installation and Setup"),Object(l.b)("h3",{id:"installing-for-the-first-time"},"Installing for the first time"),Object(l.b)("p",null,"Run the following command in an Administrator PowerShell:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),".\\install.ps1\n")),Object(l.b)("p",null,"This command will install docker and docker-compose if not already installed, build the images, and start the container(s)."),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},"Due to the inherent nature and size of Windows containers, the installation process may take a while to complete. Please be patient.")),Object(l.b)("h3",{id:"access-flexit"},"Access FlexIt"),Object(l.b)("p",null,"Visit the application at:"),Object(l.b)("p",null,Object(l.b)("inlineCode",{parentName:"p"},"http://localhost:<FLEXIT_PORT>")),Object(l.b)("p",null,"See here for how to ",Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"administration#https"}),"configure your DNS"),"."),Object(l.b)("h2",{id:"managing-the-docker-containers"},"Managing the Docker Containers"),Object(l.b)("h3",{id:"stopping-the-application"},"Stopping the Application"),Object(l.b)("p",null,"To stop the application:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),".\\scripts\\stop_server.bat\n")),Object(l.b)("h3",{id:"starting-the-application"},"Starting the Application"),Object(l.b)("p",null,"To start the application:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),".\\scripts\\start_server.bat\n")),Object(l.b)("h3",{id:"restarting-the-application"},"Restarting the Application"),Object(l.b)("p",null,"To pull the latest changes from an upstream repo and restart the application:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),".\\scripts\\restart_server.ps1\n")),Object(l.b)("h2",{id:"cleaning-up-artifacts-to-free-up-space"},"Cleaning up artifacts to free up space"),Object(l.b)("p",null,"This section provides commands to clean up Docker artifacts, including containers and images."),Object(l.b)("h3",{id:"stop-all-containers-powershell"},"stop all containers (PowerShell)"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker stop (docker ps -aq)\n")),Object(l.b)("p",null,"This command will stop all running containers in your local Docker environment. Be cautious, as this will stop all containers, including those not related to this project."),Object(l.b)("h3",{id:"delete-all-containers-powershell"},"delete all containers (PowerShell)"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker rm (docker ps -aq)\n")),Object(l.b)("p",null,"This command will remove all containers from your local Docker environment. Be cautious, as this will delete all containers, including those not related to this project."),Object(l.b)("h3",{id:"delete-all-images-powershell"},"delete all images (PowerShell)"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker rmi (docker images -q)\n")),Object(l.b)("p",null,"This command will remove all images from your local Docker environment. Be cautious, as this will delete all images, including those not related to this project."),Object(l.b)("h3",{id:"prune-to-clear-up-space"},"prune to clear up space"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker system prune -af\n")),Object(l.b)("p",null,"This command will remove all stopped containers, unused networks, dangling images, and build cache."),Object(l.b)("p",null,"To remove only unused images:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker image prune -a\n")),Object(l.b)("p",null,"To remove unused containers:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker container prune\n")),Object(l.b)("p",null,"To remove unused networks:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker network prune\n")),Object(l.b)("p",null,"To remove unused build cache:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker builder prune\n")),Object(l.b)("h2",{id:"working-with-volumes"},"Working with Volumes"),Object(l.b)("p",null,"The ",Object(l.b)("inlineCode",{parentName:"p"},"docker-compose.yml")," file uses named volumes to persist data. These volumes are created automatically when you run the application and will persist between container restarts."),Object(l.b)("p",null,"For example:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"volumes:\n  - flexit_webcontent:/opt/flexit/webcontent\n")),Object(l.b)("p",null,"This creates a named volume called ",Object(l.b)("inlineCode",{parentName:"p"},"flexit_webcontent")," that is used by the ",Object(l.b)("inlineCode",{parentName:"p"},"flexit-analytics")," service and is mapped to the ",Object(l.b)("inlineCode",{parentName:"p"},"/opt/flexit/webcontent")," directory in the container. This volume is owned by root and is not accessible by the user running the container. If you need to access or modify the data in this volume, you can use the ",Object(l.b)("inlineCode",{parentName:"p"},"docker cp")," command to copy files to the container from your local machine (or vice/versa). ",Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.docker.com/reference/cli/docker/container/cp/"}),"Further documentation from Docker here")),Object(l.b)("p",null,"For example, to copy a file.txt file from your local machine to the ",Object(l.b)("inlineCode",{parentName:"p"},"flexit_webcontent")," volume in the ",Object(l.b)("inlineCode",{parentName:"p"},"flexit-analytics")," container:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker cp file.txt flexit-analytics:/opt/flexit/webcontent/file.txt\n")),Object(l.b)("p",null,"You can also get into the container's shell directly to move around the filesystem if needed:"),Object(l.b)("p",null,"run bash from within the container (linux):"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker exec -it flexit-analytics /bin/bash\n")),Object(l.b)("p",null,"To view the volumes:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker volume ls\n")),Object(l.b)("p",null,"To inspect a specific volume:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker volume inspect <volume_name>\n")),Object(l.b)("h2",{id:"additional-notes"},"Additional Notes"),Object(l.b)("h3",{id:"viewing-logs"},"Viewing Logs"),Object(l.b)("p",null,"To view logs for the a container:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker logs <container_name>\n")),Object(l.b)("h2",{id:"troubleshooting"},"Troubleshooting"),Object(l.b)("h3",{id:"1-postgresql-connection-issues"},"1. PostgreSQL Connection Issues"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"Ensure the ",Object(l.b)("inlineCode",{parentName:"li"},"DB_USER"),", ",Object(l.b)("inlineCode",{parentName:"li"},"DB_PASSWORD"),", and ",Object(l.b)("inlineCode",{parentName:"li"},"DB_NAME")," in ",Object(l.b)("inlineCode",{parentName:"li"},".env")," match the values expected by the PostgreSQL server.")),Object(l.b)("h3",{id:"2-flexit-frontend-not-starting"},"2. FlexIt Frontend Not Starting"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Review logs:"),Object(l.b)("pre",{parentName:"li"},Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker logs flexit-frontend\n")))))}b.isMDXComponent=!0}}]);